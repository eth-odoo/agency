<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Minimal Agency Layout - NO website.layout dependency -->
    <template id="agency_minimal_layout" name="Agency Minimal Layout">
        <t t-set="html_lang" t-value="request.env.lang"/>
        <t t-set="body_classname" t-value="''"/>

        <html t-att-lang="html_lang">
            <head>
                <meta charset="utf-8"/>
                <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
                <meta name="viewport" content="width=device-width, initial-scale=1"/>

                <title><t t-esc="title or 'Agency Portal'"/></title>

                <!-- jQuery FIRST -->
                <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

                <!-- Bootstrap CSS -->
                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

                <!-- Font Awesome -->
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>

                <!-- Custom Head Content -->
                <t t-if="head" t-raw="head"/>

                <style>
                    body {
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        min-height: 100vh;
                        padding: 20px 0;
                    }
                    .wrap {
                        min-height: 80vh;
                    }
                    .card {
                        border-radius: 15px;
                        border: none;
                    }
                    .card-header {
                        border-radius: 15px 15px 0 0 !important;
                    }
                    .card-footer {
                        border-radius: 0 0 15px 15px !important;
                    }
                    .form-control {
                        border-radius: 10px;
                        border: 2px solid #e9ecef;
                        padding: 12px 15px;
                    }
                    .form-control:focus {
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
                    }
                    .btn-primary-gradient {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        border: none;
                        border-radius: 10px;
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
                    }
                    .btn-primary-gradient:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                    }
                    .language-selector-top {
                        position: absolute;
                        top: 20px;
                        right: 20px;
                        z-index: 1000;
                    }
                    .language-selector-top select {
                        background: rgba(255, 255, 255, 0.95);
                        border: 2px solid #667eea;
                        color: #495057;
                        padding: 8px 12px;
                        border-radius: 8px;
                        font-size: 0.9rem;
                        font-weight: 500;
                        cursor: pointer;
                    }
                </style>
            </head>

            <body t-att-class="body_classname">
                <t t-raw="0"/>

                <!-- Bootstrap JS -->
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
            </body>
        </html>
    </template>

    <!-- Alert Messages Template -->
    <template id="portal_alerts" name="Portal Alert Messages">
        <t t-if="error">
            <div class="alert alert-danger border-0" role="alert">
                <i class="fa fa-exclamation-triangle me-2"></i>
                <t t-if="error == 'missing_credentials'">Please enter email and password.</t>
                <t t-elif="error == 'invalid_credentials'">Invalid email or password.</t>
                <t t-elif="error == 'missing_email'">Please enter your email address.</t>
                <t t-elif="error == 'failed'">An error occurred. Please try again.</t>
                <t t-elif="error == 'invalid_password'">Password must be at least 8 characters.</t>
                <t t-elif="error == 'password_mismatch'">Passwords do not match.</t>
                <t t-else=""><t t-esc="error"/></t>
            </div>
        </t>
        <t t-if="success">
            <div class="alert alert-success border-0" role="alert">
                <i class="fa fa-check-circle me-2"></i>
                <t t-esc="success"/>
            </div>
        </t>
        <t t-if="message">
            <div class="alert alert-info border-0" role="alert">
                <i class="fa fa-info-circle me-2"></i>
                <t t-if="message == 'password_reset'">Your password has been reset. Please login with your new password.</t>
                <t t-else=""><t t-esc="message"/></t>
            </div>
        </t>
    </template>

    <!-- Login Page - Styled Version -->
    <template id="portal_login" name="Agency Portal Login">
        <t t-call="eth_agency_portal.agency_minimal_layout">
            <t t-set="title">Agency Login</t>

            <div class="wrap" style="position: relative;">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-5 col-md-7">
                            <div class="card shadow-lg border-0">
                                <div class="card-header text-white text-center border-0 py-4"
                                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <h3 class="mb-0 fw-bold">
                                        <i class="fa fa-user-circle me-2"></i>
                                        Agency Login
                                    </h3>
                                    <p class="mb-0 mt-2 opacity-75">Agency Portal</p>
                                </div>
                                <div class="card-body p-5">
                                    <t t-call="eth_agency_portal.portal_alerts"/>

                                    <form action="/agency/login/submit" method="post">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                        <div class="mb-4">
                                            <label for="email" class="form-label fw-semibold">
                                                <i class="fa fa-envelope me-2 text-muted"></i>
                                                Email Address
                                            </label>
                                            <input type="email"
                                                   class="form-control form-control-lg"
                                                   id="email"
                                                   name="email"
                                                   placeholder="agency@example.com"
                                                   required="required"
                                                   autofocus="autofocus"/>
                                        </div>

                                        <div class="mb-4">
                                            <label for="password" class="form-label fw-semibold">
                                                <i class="fa fa-lock me-2 text-muted"></i>
                                                Password
                                            </label>
                                            <input type="password"
                                                   class="form-control form-control-lg"
                                                   id="password"
                                                   name="password"
                                                   placeholder="Enter your password"
                                                   required="required"/>
                                        </div>

                                        <div class="d-grid mb-4">
                                            <button type="submit" class="btn btn-lg text-white fw-semibold btn-primary-gradient py-3">
                                                <i class="fa fa-sign-in-alt me-2"></i>
                                                Sign In
                                            </button>
                                        </div>
                                    </form>

                                    <div class="text-center mt-3">
                                        <a href="/agency/forgot-password" class="text-muted text-decoration-none">
                                            <i class="fa fa-question-circle me-1"></i>
                                            Forgot Password?
                                        </a>
                                    </div>

                                    <div class="text-center mt-4">
                                        <small class="text-muted">
                                            Need an account? <a href="/agency/register">Register here</a>
                                        </small>
                                    </div>
                                </div>
                                <div class="card-footer text-center bg-light border-0 py-3">
                                    <small class="text-muted">
                                        <i class="fa fa-shield-alt me-1"></i>
                                        Secure Login - Agency Portal
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Forgot Password Page - Styled Version -->
    <template id="portal_forgot_password" name="Forgot Password">
        <t t-call="eth_agency_portal.agency_minimal_layout">
            <t t-set="title">Reset Password</t>

            <div class="wrap" style="position: relative;">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-5 col-md-7">
                            <div class="card shadow-lg border-0">
                                <div class="card-header text-white text-center border-0 py-4"
                                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <h3 class="mb-0 fw-bold">
                                        <i class="fa fa-lock me-2"></i>
                                        Reset Password
                                    </h3>
                                    <p class="mb-0 mt-2 opacity-75">Agency Portal</p>
                                </div>
                                <div class="card-body p-5">
                                    <t t-call="eth_agency_portal.portal_alerts"/>

                                    <t t-if="not success">
                                        <p class="text-muted text-center mb-4">
                                            Enter your email address and we'll send you password reset instructions.
                                        </p>

                                        <form action="/agency/forgot-password/submit" method="post">
                                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                            <div class="mb-4">
                                                <label for="email" class="form-label fw-semibold">
                                                    <i class="fa fa-envelope me-2 text-muted"></i>
                                                    Email Address
                                                </label>
                                                <input type="email"
                                                       class="form-control form-control-lg"
                                                       id="email"
                                                       name="email"
                                                       placeholder="Enter your email address"
                                                       required="required"/>
                                            </div>

                                            <div class="d-grid mb-4">
                                                <button type="submit" class="btn btn-lg text-white fw-semibold btn-primary-gradient py-3">
                                                    <i class="fa fa-paper-plane me-2"></i>
                                                    Send Reset Instructions
                                                </button>
                                            </div>
                                        </form>
                                    </t>

                                    <t t-if="success">
                                        <div class="text-center py-4">
                                            <i class="fa fa-envelope fa-4x text-success mb-4"></i>
                                            <h5 class="text-success">Email Sent!</h5>
                                            <p class="text-muted">
                                                Check your email for password reset instructions.
                                            </p>
                                        </div>
                                    </t>

                                    <div class="text-center mt-4">
                                        <a href="/agency/login" class="btn btn-link text-decoration-none">
                                            <i class="fa fa-arrow-left me-1"></i>
                                            Back to Login
                                        </a>
                                    </div>
                                </div>
                                <div class="card-footer text-center bg-light border-0 py-3">
                                    <small class="text-muted">
                                        <i class="fa fa-shield-alt me-1"></i>
                                        Secure Transaction - Agency Portal
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Reset Password Page - Styled Version -->
    <template id="portal_reset_password" name="Reset Password Form">
        <t t-call="eth_agency_portal.agency_minimal_layout">
            <t t-set="title">Set New Password</t>

            <div class="wrap" style="position: relative;">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-5 col-md-7">
                            <div class="card shadow-lg border-0">
                                <div class="card-header text-white text-center border-0 py-4"
                                     style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                    <h3 class="mb-0 fw-bold">
                                        <i class="fa fa-key me-2"></i>
                                        Set New Password
                                    </h3>
                                    <p class="mb-0 mt-2 opacity-75">Agency Portal</p>
                                </div>
                                <div class="card-body p-5">
                                    <t t-call="eth_agency_portal.portal_alerts"/>

                                    <p class="text-muted text-center mb-4">
                                        Enter your new password below.
                                    </p>

                                    <form t-attf-action="/agency/reset-password/#{token}/submit" method="post">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                                        <div class="mb-4">
                                            <label for="password" class="form-label fw-semibold">
                                                <i class="fa fa-lock me-2 text-muted"></i>
                                                New Password
                                            </label>
                                            <input type="password"
                                                   class="form-control form-control-lg"
                                                   id="password"
                                                   name="password"
                                                   placeholder="Enter new password"
                                                   required="required"
                                                   minlength="8"/>
                                            <div class="form-text">Minimum 8 characters</div>
                                        </div>

                                        <div class="mb-4">
                                            <label for="confirm_password" class="form-label fw-semibold">
                                                <i class="fa fa-lock me-2 text-muted"></i>
                                                Confirm Password
                                            </label>
                                            <input type="password"
                                                   class="form-control form-control-lg"
                                                   id="confirm_password"
                                                   name="confirm_password"
                                                   placeholder="Re-enter new password"
                                                   required="required"/>
                                        </div>

                                        <div class="d-grid mb-4">
                                            <button type="submit" class="btn btn-lg btn-success fw-semibold py-3" style="border-radius: 10px;">
                                                <i class="fa fa-check me-2"></i>
                                                Reset Password
                                            </button>
                                        </div>
                                    </form>

                                    <div class="text-center mt-4">
                                        <a href="/agency/login" class="btn btn-link text-decoration-none">
                                            <i class="fa fa-arrow-left me-1"></i>
                                            Back to Login
                                        </a>
                                    </div>
                                </div>
                                <div class="card-footer text-center bg-light border-0 py-3">
                                    <small class="text-muted">
                                        <i class="fa fa-shield-alt me-1"></i>
                                        Secure Transaction - Agency Portal
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Invalid Reset Token Page - Styled Version -->
    <template id="portal_reset_password_invalid" name="Invalid Reset Token">
        <t t-call="eth_agency_portal.agency_minimal_layout">
            <t t-set="title">Invalid Link</t>

            <div class="wrap">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-5 col-md-7">
                            <div class="card shadow-lg border-0">
                                <div class="card-body text-center py-5">
                                    <i class="fas fa-exclamation-triangle text-danger fa-4x mb-4"></i>
                                    <h4 class="text-danger fw-bold">Invalid or Expired Link</h4>
                                    <p class="text-muted mb-4">
                                        This password reset link is invalid or has expired.
                                    </p>
                                    <a href="/agency/forgot-password" class="btn btn-primary fw-semibold btn-primary-gradient px-4 py-2">
                                        <i class="fas fa-redo me-2"></i>
                                        Request New Link
                                    </a>
                                    <div class="mt-4">
                                        <a href="/agency/login" class="text-muted text-decoration-none">
                                            <i class="fa fa-arrow-left me-1"></i>
                                            Back to Login
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>
